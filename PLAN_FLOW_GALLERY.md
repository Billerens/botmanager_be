# Flow Template Gallery ‚Äî –ì–∞–ª–µ—Ä–µ—è —à–∞–±–ª–æ–Ω–æ–≤ Bot Flow

> **–°—Ç–∞—Ç—É—Å:** –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ  
> **–î–∞—Ç–∞:** 2025-02-11  
> **–°–≤—è–∑–∞–Ω —Å:** PLAN_SMART_SETUP.md (FlowPreset entity)

## –û–±–∑–æ—Ä

–ì–∞–ª–µ—Ä–µ—è —à–∞–±–ª–æ–Ω–æ–≤ bot flow —Å –¥–≤—É–º—è —Ç–∏–ø–∞–º–∏ —Ç–µ–º–ø–ª–µ–π—Ç–æ–≤ (–ø–æ–ª–Ω—ã–µ –∏ —á–∞—Å—Ç–∏—á–Ω—ã–µ), —Å–∏—Å—Ç–µ–º–æ–π –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö flow, –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–µ–π —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä FlowBuilder.

---

## –ó–∞–¥–∞—á–∏

- [x] Backend: Entity `FlowTemplate` + –º–∏–≥—Ä–∞—Ü–∏—è
- [x] Backend: Entity `FlowTemplateCategory` (—Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –∫–∞—Ç–µ–≥–æ—Ä–∏–π —Å i18n) + –º–∏–≥—Ä–∞—Ü–∏—è
- [x] Backend: CRUD API –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö —Ç–µ–º–ø–ª–µ–π—Ç–æ–≤ (`/flow-templates`)
- [x] Backend: –ü—É–±–ª–∏—á–Ω—ã–π API –≥–∞–ª–µ—Ä–µ–∏ (`/flow-templates/gallery`)
- [x] Backend: –ê–¥–º–∏–Ω-–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –¥–ª—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è (`/admin/flow-templates`)
- [x] Backend: –ê–¥–º–∏–Ω-–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –¥–ª—è —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π (`/admin/flow-template-categories`)
- [x] Backend: –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∞–≤—Ç–æ—Ä—É –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Å—Ç–∞—Ç—É—Å–∞ —Ç–µ–º–ø–ª–µ–π—Ç–∞
- [x] Frontend: –ö–æ–º–ø–æ–Ω–µ–Ω—Ç `TemplateGallery` (–ø–æ–∏—Å–∫, —Ñ–∏–ª—å—Ç—Ä, –ø—Ä–µ–≤—å—é, –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ)
- [x] Frontend: –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–≥–æ flow –∫–∞–∫ —Ç–µ–º–ø–ª–µ–π—Ç–∞
- [x] Frontend: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≥–∞–ª–µ—Ä–µ–∏ –≤ FlowBuilder (–∫–Ω–æ–ø–∫–∞ + –ø–∞–Ω–µ–ª—å)
- [x] Frontend: –ê–¥–º–∏–Ω-—Å—Ç—Ä–∞–Ω–∏—Ü–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç–µ–º–ø–ª–µ–π—Ç–∞–º–∏ + –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è
- [x] Frontend: –ê–¥–º–∏–Ω-—Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π
- [x] Frontend: –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä —Ç–µ–º–ø–ª–µ–π—Ç–∞ (–º–∏–Ω–∏-ReactFlow readonly)
- [x] Frontend: –õ–æ–≥–∏–∫–∞ –º–µ—Ä–∂–∞ —á–∞—Å—Ç–∏—á–Ω–æ–≥–æ —Ç–µ–º–ø–ª–µ–π—Ç–∞ –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π flow

---

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                           –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å                               ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îÇ
‚îÇ  ‚îÇ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–µ–º–ø–ª–µ–π—Ç–∞–º–∏  ‚îÇ  ‚îÇ –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö   ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ (—Å–æ–∑–¥–∞–Ω–∏–µ, –ø–æ–º–µ—Ç–∫–∞      ‚îÇ  ‚îÇ —Ç–µ–º–ø–ª–µ–π—Ç–æ–≤                     ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ  "–≤—ã–±–æ—Ä –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã")     ‚îÇ  ‚îÇ (approve / reject)             ‚îÇ    ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
               ‚îÇ                               ‚îÇ
               ‚ñº                               ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                         FlowTemplate (–ë–î)                            ‚îÇ
‚îÇ                                                                      ‚îÇ
‚îÇ  type: 'full' | 'partial'                                            ‚îÇ
‚îÇ  status: 'draft' | 'private' | 'pending_review' | 'published'       ‚îÇ
‚îÇ  isPlatformChoice: boolean       ‚Üê –ø–æ–º–µ—á–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω–∫—É         ‚îÇ
‚îÇ  authorId: UUID | null           ‚Üê null –¥–ª—è —Å–∏—Å—Ç–µ–º–Ω—ã—Ö               ‚îÇ
‚îÇ  flowData: { nodes, edges, viewport }                                ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                       ‚îÇ
          ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
          ‚ñº                         ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å    ‚îÇ   ‚îÇ  FlowBuilder Editor     ‚îÇ
‚îÇ  "–ú–æ–∏ —Ç–µ–º–ø–ª–µ–π—Ç—ã" ‚îÇ   ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ  (private +      ‚îÇ   ‚îÇ  ‚îÇ  –ì–∞–ª–µ—Ä–µ—è —à–∞–±–ª–æ–Ω–æ–≤   ‚îÇ ‚îÇ
‚îÇ   published)     ‚îÇ   ‚îÇ  ‚îÇ  [–ü–æ–∏—Å–∫] [–§–∏–ª—å—Ç—Ä]  ‚îÇ ‚îÇ
‚îÇ                  ‚îÇ   ‚îÇ  ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îê      ‚îÇ ‚îÇ
‚îÇ  "–û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å"‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚ñ∫‚îÇ  ‚îÇ  ‚îÇFull‚îÇ ‚îÇPart‚îÇ      ‚îÇ ‚îÇ
‚îÇ                  ‚îÇ   ‚îÇ  ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îò      ‚îÇ ‚îÇ
‚îÇ                  ‚îÇ   ‚îÇ  ‚îÇ  [–ü—Ä–µ–≤—å—é] [–ü—Ä–∏–º–µ–Ω–∏—Ç—å]‚îÇ ‚îÇ
‚îÇ                  ‚îÇ   ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## –ß–∞—Å—Ç—å 1: Entity `FlowTemplate`

### 1.1 –ú–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö

**–ü—É—Ç—å:** `backend/src/database/entities/flow-template.entity.ts`

```typescript
@Entity('flow_templates')
class FlowTemplate {
  @PrimaryGeneratedColumn('uuid')
  id: string;

  // --- –û—Å–Ω–æ–≤–Ω–æ–µ ---

  @Column({ length: 128 })
  name: string;                       // "–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤"

  @Column({ type: 'text', nullable: true })
  description: string;                // "–®–∞–±–ª–æ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–∏..."

  @Column({ type: 'enum', enum: FlowTemplateType })
  type: FlowTemplateType;             // 'full' | 'partial'

  @ManyToOne(() => FlowTemplateCategory, { nullable: true, onDelete: 'SET NULL' })
  @JoinColumn({ name: 'categoryId' })
  category: FlowTemplateCategory;

  @Column({ type: 'uuid', nullable: true })
  categoryId: string | null;

  @Column({ type: 'text', array: true, default: '{}' })
  tags: string[];                     // ["support", "customer", "faq"]

  // --- –°–æ–¥–µ—Ä–∂–∏–º–æ–µ ---

  @Column({ type: 'jsonb' })
  flowData: {
    nodes: FlowNodeDto[];
    edges: FlowEdgeDto[];
    viewport?: { x: number; y: number; zoom: number };
  };

  // --- –ü—É–±–ª–∏–∫–∞—Ü–∏—è ---

  @Column({
    type: 'enum',
    enum: FlowTemplateStatus,
    default: FlowTemplateStatus.DRAFT,
  })
  status: FlowTemplateStatus;
  // 'draft'             ‚Äî —á–µ—Ä–Ω–æ–≤–∏–∫ (—Ç–æ–ª—å–∫–æ –∞–≤—Ç–æ—Ä –≤–∏–¥–∏—Ç)
  // 'private'           ‚Äî —Å–æ—Ö—Ä–∞–Ω—ë–Ω –¥–ª—è –ª–∏—á–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
  // 'pending_review'    ‚Äî –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –Ω–∞ –º–æ–¥–µ—Ä–∞—Ü–∏—é
  // 'published'         ‚Äî –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω –≤ –≥–∞–ª–µ—Ä–µ–µ
  // 'rejected'          ‚Äî –æ—Ç–∫–ª–æ–Ω—ë–Ω –º–æ–¥–µ—Ä–∞—Ü–∏–µ–π
  // 'pending_deletion'  ‚Äî –∞–≤—Ç–æ—Ä –∑–∞–ø—Ä–æ—Å–∏–ª —É–¥–∞–ª–µ–Ω–∏–µ, –æ–∂–∏–¥–∞–µ—Ç —Ä–µ—à–µ–Ω–∏—è –∞–¥–º–∏–Ω–∞
  // 'archived'          ‚Äî –ø–µ—Ä–µ–Ω–µ—Å—ë–Ω –≤ –∞—Ä—Ö–∏–≤ (soft delete)

  @Column({ default: false })
  isPlatformChoice: boolean;          // –ü–æ–º–µ—á–µ–Ω –∞–¥–º–∏–Ω–æ–º –∫–∞–∫ "–í—ã–±–æ—Ä –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã"

  @Column({ nullable: true })
  rejectionReason: string;            // –ü—Ä–∏—á–∏–Ω–∞ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è (–∑–∞–ø–æ–ª–Ω—è–µ—Ç –∞–¥–º–∏–Ω)

  @Column({ type: 'text', nullable: true })
  deletionRequestReason: string;      // –ü—Ä–∏—á–∏–Ω–∞ –∑–∞–ø—Ä–æ—Å–∞ –Ω–∞ —É–¥–∞–ª–µ–Ω–∏–µ (–∑–∞–ø–æ–ª–Ω—è–µ—Ç –∞–≤—Ç–æ—Ä)

  // --- –ê–≤—Ç–æ—Ä ---

  @ManyToOne(() => User, { nullable: true, onDelete: 'SET NULL' })
  @JoinColumn({ name: 'authorId' })
  author: User;

  @Column({ type: 'uuid', nullable: true })
  authorId: string | null;            // null = —Å–∏—Å—Ç–µ–º–Ω—ã–π / —Å–æ–∑–¥–∞–Ω–Ω—ã–π –∞–¥–º–∏–Ω–æ–º

  // --- –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ ---

  @Column({ type: 'int', default: 0 })
  usageCount: number;                 // –°–∫–æ–ª—å–∫–æ —Ä–∞–∑ –ø—Ä–∏–º–µ–Ω—ë–Ω

  @Column({ type: 'int', default: 0 })
  nodeCount: number;                  // –ö–æ–ª-–≤–æ –Ω–æ–¥ (–¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è)

  @Column({ type: 'int', default: 0 })
  sortOrder: number;                  // –ü–æ—Ä—è–¥–æ–∫ –≤ –≥–∞–ª–µ—Ä–µ–µ

  @CreateDateColumn()
  createdAt: Date;

  @UpdateDateColumn()
  updatedAt: Date;

  @Column({ type: 'timestamp', nullable: true })
  publishedAt: Date;                  // –î–∞—Ç–∞ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏

  @Column({ type: 'timestamp', nullable: true })
  archivedAt: Date;                   // –î–∞—Ç–∞ –∞—Ä—Ö–∏–≤–∞—Ü–∏–∏ (soft delete)
}
```

### 1.2 Enums

```typescript
enum FlowTemplateType {
  FULL = 'full',         // –ü–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–º–µ–Ω—è–µ—Ç —Ç–µ–∫—É—â–∏–π flow
  PARTIAL = 'partial',   // –í—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π flow
}

enum FlowTemplateStatus {
  DRAFT = 'draft',
  PRIVATE = 'private',
  PENDING_REVIEW = 'pending_review',
  PUBLISHED = 'published',
  REJECTED = 'rejected',
  PENDING_DELETION = 'pending_deletion',
  ARCHIVED = 'archived',
}
```

### 1.3 Entity `FlowTemplateCategory` ‚Äî —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –∫–∞—Ç–µ–≥–æ—Ä–∏–π

**–ü—É—Ç—å:** `backend/src/database/entities/flow-template-category.entity.ts`

```typescript
@Entity('flow_template_categories')
class FlowTemplateCategory {
  @PrimaryGeneratedColumn('uuid')
  id: string;

  @Column({ length: 64, unique: true })
  slug: string;                       // "support", "sales", "ecommerce"

  @Column({ type: 'jsonb' })
  name: {                             // –õ–æ–∫–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è
    ru: string;                       // "–ü–æ–¥–¥–µ—Ä–∂–∫–∞"
    en: string;                       // "Support"
    pl: string;                       // "Wsparcie"
    de: string;                       // "Support"
    ua: string;                       // "–ü—ñ–¥—Ç—Ä–∏–º–∫–∞"
  };

  @Column({ type: 'jsonb', nullable: true })
  description: {                      // –õ–æ–∫–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –æ–ø–∏—Å–∞–Ω–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
    ru?: string;
    en?: string;
    pl?: string;
    de?: string;
    ua?: string;
  };

  @Column({ nullable: true })
  icon: string;                       // Emoji –∏–ª–∏ –∏–º—è –∏–∫–æ–Ω–∫–∏ Ant Design

  @Column({ default: true })
  isActive: boolean;

  @Column({ type: 'int', default: 0 })
  sortOrder: number;

  @CreateDateColumn()
  createdAt: Date;

  @UpdateDateColumn()
  updatedAt: Date;
}
```

### 1.4 –ú–∏–≥—Ä–∞—Ü–∏—è

**–ü—É—Ç—å:** `backend/src/database/migrations/XXXX-CreateFlowTemplates.ts`

- –¢–∞–±–ª–∏—Ü–∞ `flow_template_categories`
- –¢–∞–±–ª–∏—Ü–∞ `flow_templates` —Å FK `categoryId ‚Üí flow_template_categories.id`
- –ò–Ω–¥–µ–∫—Å—ã: `status`, `type`, `authorId`, `categoryId`, `isPlatformChoice`
- GIN-–∏–Ω–¥–µ–∫—Å –Ω–∞ `tags` –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞ –ø–æ —Ç–µ–≥–∞–º

---

## –ß–∞—Å—Ç—å 2: Backend API

### 2.1 –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π API ‚Äî `FlowTemplatesController`

**–ü—É—Ç—å:** `backend/src/modules/flow-templates/flow-templates.controller.ts`

**Guard:** `JwtAuthGuard` (–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å)

| –ú–µ—Ç–æ–¥  | –ü—É—Ç—å                                    | –û–ø–∏—Å–∞–Ω–∏–µ                                    |
|--------|-----------------------------------------|---------------------------------------------|
| GET    | `/flow-templates/gallery`               | –ì–∞–ª–µ—Ä–µ—è: published —Ç–µ–º–ø–ª–µ–π—Ç—ã + –ø–æ–∏—Å–∫        |
| GET    | `/flow-templates/gallery/:id`           | –î–µ—Ç–∞–ª–∏ —Ç–µ–º–ø–ª–µ–π—Ç–∞ –∏–∑ –≥–∞–ª–µ—Ä–µ–∏                 |
| GET    | `/flow-templates/my`                    | –ú–æ–∏ —Ç–µ–º–ø–ª–µ–π—Ç—ã (–≤—Å–µ —Å—Ç–∞—Ç—É—Å—ã)                 |
| POST   | `/flow-templates`                       | –°–æ–∑–¥–∞—Ç—å —Ç–µ–º–ø–ª–µ–π—Ç –∏–∑ —Ç–µ–∫—É—â–µ–≥–æ flow           |
| PUT    | `/flow-templates/:id`                   | –û–±–Ω–æ–≤–∏—Ç—å —Å–≤–æ–π —Ç–µ–º–ø–ª–µ–π—Ç (draft/private/rejected)   |
| DELETE | `/flow-templates/:id`                   | –ê—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞—Ç—å —Å–≤–æ–π —Ç–µ–º–ø–ª–µ–π—Ç (—Ç–æ–ª—å–∫–æ draft/private/rejected) |
| POST   | `/flow-templates/:id/publish`           | –û—Ç–ø—Ä–∞–≤–∏—Ç—å –Ω–∞ –º–æ–¥–µ—Ä–∞—Ü–∏—é (status ‚Üí pending_review)  |
| POST   | `/flow-templates/:id/request-deletion`  | –ó–∞–ø—Ä–æ—Å–∏—Ç—å —É–¥–∞–ª–µ–Ω–∏–µ published (‚Üí pending_deletion) |
| POST   | `/flow-templates/:id/apply`             | –ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ (usageCount++)           |

#### –ì–∞–ª–µ—Ä–µ—è ‚Äî `GET /flow-templates/gallery`

**Query –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**

```typescript
class GalleryQueryDto {
  search?: string;          // –ü–æ–∏—Å–∫ –ø–æ name, description, tags
  type?: FlowTemplateType;  // full | partial
  categoryId?: string;      // –§–∏–ª—å—Ç—Ä –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (UUID)
  tags?: string[];          // –§–∏–ª—å—Ç—Ä –ø–æ —Ç–µ–≥–∞–º
  isPlatformChoice?: boolean; // –¢–æ–ª—å–∫–æ "–í—ã–±–æ—Ä –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã"
  sortBy?: 'popular' | 'newest' | 'name'; // –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞
  page?: number;
  limit?: number;
}
```

**–û—Ç–≤–µ—Ç:**

```typescript
interface GalleryResponse {
  items: FlowTemplateListItem[];
  total: number;
  page: number;
  limit: number;
}

interface FlowTemplateListItem {
  id: string;
  name: string;
  description: string;
  type: FlowTemplateType;
  category: { id: string; slug: string; name: LocalizedString } | null;
  tags: string[];
  isPlatformChoice: boolean;
  usageCount: number;
  nodeCount: number;
  authorName: string | null; // null –¥–ª—è —Å–∏—Å—Ç–µ–º–Ω—ã—Ö
  publishedAt: string;
  // flowData –ù–ï –≤–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —Å–ø–∏—Å–æ–∫ ‚Äî —Ç–æ–ª—å–∫–æ –ø—Ä–∏ GET /gallery/:id
}
```

#### –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ–º–ø–ª–µ–π—Ç–∞ ‚Äî `POST /flow-templates`

```typescript
class CreateFlowTemplateDto {
  @IsString() @MaxLength(128)
  name: string;

  @IsOptional() @IsString()
  description?: string;

  @IsEnum(FlowTemplateType)
  type: FlowTemplateType;

  @IsOptional() @IsUUID()
  categoryId?: string;

  @IsOptional() @IsArray() @IsString({ each: true })
  tags?: string[];

  @IsObject()
  flowData: FlowDataDto; // { nodes, edges, viewport }

  @IsOptional() @IsEnum(FlowTemplateStatus)
  initialStatus?: 'draft' | 'private'; // –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é 'draft'
}
```

**–ë–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª–∞:**
- `authorId` —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑ JWT
- `nodeCount` –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –∏–∑ `flowData.nodes.length`
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å –Ω–µ –±–æ–ª–µ–µ 50 —Ç–µ–º–ø–ª–µ–π—Ç–æ–≤ (–ª–∏–º–∏—Ç)

#### –ó–∞–ø—Ä–æ—Å –Ω–∞ —É–¥–∞–ª–µ–Ω–∏–µ ‚Äî `POST /flow-templates/:id/request-deletion`

```typescript
class RequestDeletionDto {
  @IsOptional() @IsString()
  reason?: string; // –ü—Ä–∏—á–∏–Ω–∞ –∑–∞–ø—Ä–æ—Å–∞ –Ω–∞ —É–¥–∞–ª–µ–Ω–∏–µ
}
```

**–ë–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª–∞:**
- –¢–æ–ª—å–∫–æ –¥–ª—è `status = 'published'` (–¥–ª—è draft/private/rejected ‚Äî DELETE ‚Üí archived)
- –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç `status = 'pending_deletion'`, `deletionRequestReason = reason`
- –¢–µ–º–ø–ª–µ–π—Ç –æ—Å—Ç–∞—ë—Ç—Å—è –≤–∏–¥–∏–º—ã–º –≤ –≥–∞–ª–µ—Ä–µ–µ –¥–æ —Ä–µ—à–µ–Ω–∏—è –∞–¥–º–∏–Ω–∞
- –ê–≤—Ç–æ—Ä –Ω–µ –º–æ–∂–µ—Ç —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–º–ø–ª–µ–π—Ç –≤ —Å—Ç–∞—Ç—É—Å–µ `pending_deletion`

### 2.2 –ê–¥–º–∏–Ω API ‚Äî `AdminFlowTemplatesController`

**–ü—É—Ç—å:** `backend/src/modules/admin/controllers/admin-flow-templates.controller.ts`

**Guard:** `AdminJwtGuard`, `AdminRolesGuard`

| –ú–µ—Ç–æ–¥  | –ü—É—Ç—å                                       | –û–ø–∏—Å–∞–Ω–∏–µ                                    |
|--------|--------------------------------------------|---------------------------------------------|
| GET    | `/admin/flow-templates`                    | –í—Å–µ —Ç–µ–º–ø–ª–µ–π—Ç—ã (—Ñ–∏–ª—å—Ç—Ä –ø–æ status, type, author) |
| GET    | `/admin/flow-templates/:id`                | –î–µ—Ç–∞–ª–∏ —Ç–µ–º–ø–ª–µ–π—Ç–∞                            |
| POST   | `/admin/flow-templates`                    | –°–æ–∑–¥–∞—Ç—å —Å–∏—Å—Ç–µ–º–Ω—ã–π —Ç–µ–º–ø–ª–µ–π—Ç (authorId = null) |
| PUT    | `/admin/flow-templates/:id`                | –û–±–Ω–æ–≤–∏—Ç—å –ª—é–±–æ–π —Ç–µ–º–ø–ª–µ–π—Ç                     |
| DELETE | `/admin/flow-templates/:id`                | –ê—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞—Ç—å –ª—é–±–æ–π —Ç–µ–º–ø–ª–µ–π—Ç                  |
| POST   | `/admin/flow-templates/:id/approve`         | –û–¥–æ–±—Ä–∏—Ç—å –ø—É–±–ª–∏–∫–∞—Ü–∏—é ‚Üí status = published     |
| POST   | `/admin/flow-templates/:id/reject`          | –û—Ç–∫–ª–æ–Ω–∏—Ç—å –ø—É–±–ª–∏–∫–∞—Ü–∏—é ‚Üí status = rejected     |
| POST   | `/admin/flow-templates/:id/approve-deletion`| –û–¥–æ–±—Ä–∏—Ç—å —É–¥–∞–ª–µ–Ω–∏–µ ‚Üí status = archived        |
| POST   | `/admin/flow-templates/:id/reject-deletion` | –û—Ç–∫–ª–æ–Ω–∏—Ç—å —É–¥–∞–ª–µ–Ω–∏–µ ‚Üí status = published      |
| POST   | `/admin/flow-templates/:id/platform-choice` | –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å/—Å–Ω—è—Ç—å isPlatformChoice            |
| POST   | `/admin/flow-templates/:id/duplicate`       | –î—É–±–ª–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–º–ø–ª–µ–π—Ç                         |

#### –û–¥–æ–±—Ä–µ–Ω–∏–µ ‚Äî `POST /admin/flow-templates/:id/approve`

```typescript
// –¢–æ–ª—å–∫–æ –¥–ª—è status = 'pending_review'
// –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç: status = 'published', publishedAt = now()
```

#### –û—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ ‚Äî `POST /admin/flow-templates/:id/reject`

```typescript
class RejectTemplateDto {
  @IsString()
  reason: string; // –ü—Ä–∏—á–∏–Ω–∞ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è ‚Äî –≤–∏–¥–Ω–∞ –∞–≤—Ç–æ—Ä—É
}
// –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç: status = 'rejected', rejectionReason = reason
```

#### –û–¥–æ–±—Ä–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–∏—è ‚Äî `POST /admin/flow-templates/:id/approve-deletion`

```typescript
// –¢–æ–ª—å–∫–æ –¥–ª—è status = 'pending_deletion'
// –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç: status = 'archived', archivedAt = now()
// –¢–µ–º–ø–ª–µ–π—Ç —Å–∫—Ä—ã–≤–∞–µ—Ç—Å—è –∏–∑ –≥–∞–ª–µ—Ä–µ–∏, –Ω–æ –æ—Å—Ç–∞—ë—Ç—Å—è –≤ –ë–î
```

#### –û—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–∏—è ‚Äî `POST /admin/flow-templates/:id/reject-deletion`

```typescript
class RejectDeletionDto {
  @IsOptional() @IsString()
  reason?: string; // –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π ‚Äî –ø–æ—á–µ–º—É –Ω–µ —É–¥–∞–ª—è–µ–º
}
// –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç: status = 'published' (–≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–±—Ä–∞—Ç–Ω–æ –≤ –≥–∞–ª–µ—Ä–µ—é)
```

#### –ü–æ–º–µ—Ç–∫–∞ "–í—ã–±–æ—Ä –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã" ‚Äî `POST /admin/flow-templates/:id/platform-choice`

```typescript
class PlatformChoiceDto {
  @IsBoolean()
  isPlatformChoice: boolean;
}
// –î–æ—Å—Ç—É–ø–Ω–æ –¥–ª—è –ª—é–±—ã—Ö published —Ç–µ–º–ø–ª–µ–π—Ç–æ–≤
// "–í—ã–±–æ—Ä –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã" –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤–≤–µ—Ä—Ö—É –≥–∞–ª–µ—Ä–µ–∏
```

### 2.3 –ê–¥–º–∏–Ω API –∫–∞—Ç–µ–≥–æ—Ä–∏–π ‚Äî `AdminFlowTemplateCategoriesController`

**–ü—É—Ç—å:** `backend/src/modules/admin/controllers/admin-flow-template-categories.controller.ts`

| –ú–µ—Ç–æ–¥  | –ü—É—Ç—å                                            | –û–ø–∏—Å–∞–Ω–∏–µ                        |
|--------|------------------------------------------------|----------------------------------|
| GET    | `/admin/flow-template-categories`              | –í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏                    |
| POST   | `/admin/flow-template-categories`              | –°–æ–∑–¥–∞—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é                |
| PUT    | `/admin/flow-template-categories/:id`          | –û–±–Ω–æ–≤–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é               |
| DELETE | `/admin/flow-template-categories/:id`          | –£–¥–∞–ª–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é (soft delete)  |

#### –°–æ–∑–¥–∞–Ω–∏–µ/–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏

```typescript
class UpsertCategoryDto {
  @IsString() @MaxLength(64)
  slug: string;

  @IsObject()
  name: { ru: string; en: string; pl: string; de: string; ua: string };

  @IsOptional() @IsObject()
  description?: { ru?: string; en?: string; pl?: string; de?: string; ua?: string };

  @IsOptional() @IsString()
  icon?: string;

  @IsOptional() @IsBoolean()
  isActive?: boolean;

  @IsOptional() @IsInt()
  sortOrder?: number;
}
```

### 2.4 –ü—É–±–ª–∏—á–Ω—ã–π —ç–Ω–¥–ø–æ–∏–Ω—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏–π

| –ú–µ—Ç–æ–¥ | –ü—É—Ç—å                              | –û–ø–∏—Å–∞–Ω–∏–µ                             |
|-------|-----------------------------------|--------------------------------------|
| GET   | `/flow-templates/categories`      | –ê–∫—Ç–∏–≤–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (–¥–ª—è —Ñ–∏–ª—å—Ç—Ä–æ–≤)    |

–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç `FlowTemplateCategory[]` –≥–¥–µ `isActive = true`, –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ `sortOrder`. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ `GalleryFilters` –∏ `SaveAsTemplateModal`.

### 2.5 –ú–æ–¥—É–ª—å

**–ü—É—Ç—å:** `backend/src/modules/flow-templates/`

```
flow-templates/
‚îú‚îÄ‚îÄ flow-templates.module.ts
‚îú‚îÄ‚îÄ flow-templates.controller.ts       # –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π API
‚îú‚îÄ‚îÄ flow-templates.service.ts          # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îú‚îÄ‚îÄ flow-template-categories.service.ts # –õ–æ–≥–∏–∫–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π
‚îú‚îÄ‚îÄ dto/
‚îÇ   ‚îú‚îÄ‚îÄ create-flow-template.dto.ts
‚îÇ   ‚îú‚îÄ‚îÄ update-flow-template.dto.ts
‚îÇ   ‚îú‚îÄ‚îÄ gallery-query.dto.ts
‚îÇ   ‚îú‚îÄ‚îÄ reject-template.dto.ts
‚îÇ   ‚îî‚îÄ‚îÄ upsert-category.dto.ts
‚îî‚îÄ‚îÄ flow-template.types.ts             # Enums, interfaces
```

–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤ `app.module.ts`:
```typescript
imports: [
  TypeOrmModule.forFeature([FlowTemplate, FlowTemplateCategory]),
  UsersModule, // –¥–ª—è authorName
]
```

---

## –ß–∞—Å—Ç—å 3: –õ–æ–≥–∏–∫–∞ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è —Ç–µ–º–ø–ª–µ–π—Ç–æ–≤

### 3.1 –ü–æ–ª–Ω—ã–π —Ç–µ–º–ø–ª–µ–π—Ç (type = 'full')

**–ü–æ–≤–µ–¥–µ–Ω–∏–µ:** –ü–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–º–µ–Ω—è–µ—Ç —Ç–µ–∫—É—â–∏–π flow.

```
–¢–µ–∫—É—â–∏–π flow:
  [Start] ‚Üí [Message A] ‚Üí [End]

+ –ü–æ–ª–Ω—ã–π —Ç–µ–º–ø–ª–µ–π—Ç "E-commerce":
  [Start] ‚Üí [New Message] ‚Üí [Condition] ‚Üí [Keyboard] ‚Üí [API] ‚Üí [End]

= –†–µ–∑—É–ª—å—Ç–∞—Ç:
  [Start] ‚Üí [New Message] ‚Üí [Condition] ‚Üí [Keyboard] ‚Üí [API] ‚Üí [End]
```

**–ê–ª–≥–æ—Ä–∏—Ç–º (—Ñ—Ä–æ–Ω—Ç–µ–Ω–¥):**
1. –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ: ¬´–¢–µ–∫—É—â–∏–π flow –±—É–¥–µ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–º–µ–Ω—ë–Ω. –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å?¬ª
2. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–æ–≤—ã—Ö `id` –¥–ª—è –≤—Å–µ—Ö –Ω–æ–¥ –∏ —Ä—ë–±–µ—Ä (–∏–∑–±–µ–∂–∞–Ω–∏–µ –∫–æ–ª–ª–∏–∑–∏–π)
3. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Å—ã–ª–æ–∫ –≤ edges (`source`, `target`) –ø–æ –º–∞–ø–ø–∏–Ω–≥—É —Å—Ç–∞—Ä—ã—Ö ‚Üí –Ω–æ–≤—ã—Ö id
4. `setNodes(newNodes)`, `setEdges(newEdges)`
5. `fitView()` –¥–ª—è –ø–æ–¥–≥–æ–Ω–∫–∏ viewport

### 3.2 –ß–∞—Å—Ç–∏—á–Ω—ã–π —Ç–µ–º–ø–ª–µ–π—Ç (type = 'partial')

**–ü–æ–≤–µ–¥–µ–Ω–∏–µ:** –î–æ–±–∞–≤–ª—è–µ—Ç—Å—è –∫ —Ç–µ–∫—É—â–µ–º—É flow, –Ω–µ –∑–∞–º–µ–Ω—è—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –Ω–æ–¥—ã.

```
–¢–µ–∫—É—â–∏–π flow:
  [Start] ‚Üí [Message A] ‚Üí [End]

+ –ß–∞—Å—Ç–∏—á–Ω—ã–π —Ç–µ–º–ø–ª–µ–π—Ç "FAQ –±–ª–æ–∫":
  [Condition: FAQ?] ‚Üí [Message: FAQ Answer] ‚Üí [Keyboard: Rate]

= –†–µ–∑—É–ª—å—Ç–∞—Ç:
  [Start] ‚Üí [Message A] ‚Üí [End]
  [Condition: FAQ?] ‚Üí [Message: FAQ Answer] ‚Üí [Keyboard: Rate]
  (–Ω–æ–≤—ã–µ –Ω–æ–¥—ã —Ä–∞–∑–º–µ—â–µ–Ω—ã —Ä—è–¥–æ–º, –Ω–µ –ø–æ–¥–∫–ª—é—á–µ–Ω—ã –∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º)
```

**–ê–ª–≥–æ—Ä–∏—Ç–º (—Ñ—Ä–æ–Ω—Ç–µ–Ω–¥):**
1. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–æ–≤—ã—Ö `id` –¥–ª—è –Ω–æ–¥ –∏ —Ä—ë–±–µ—Ä —Ç–µ–º–ø–ª–µ–π—Ç–∞
2. –í—ã—á–∏—Å–ª–µ–Ω–∏–µ bounding box —Ç–µ–∫—É—â–µ–≥–æ flow (max X + –æ—Ç—Å—Ç—É–ø)
3. –°–º–µ—â–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–π –Ω–æ–¥ —Ç–µ–º–ø–ª–µ–π—Ç–∞ –≤–ø—Ä–∞–≤–æ/–≤–Ω–∏–∑ –æ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö
4. `setNodes([...currentNodes, ...offsettedNewNodes])`
5. `setEdges([...currentEdges, ...newEdges])`
6. –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: –∞–≤—Ç–æ—Å–∫—Ä–æ–ª–ª –∫ –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–º –Ω–æ–¥–∞–º

**–ê–ª–≥–æ—Ä–∏—Ç–º –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è:**
```typescript
function calculateInsertOffset(existingNodes: FlowNode[]): { x: number; y: number } {
  if (existingNodes.length === 0) return { x: 0, y: 0 };

  const maxX = Math.max(...existingNodes.map(n => n.position.x));
  const avgY = existingNodes.reduce((sum, n) => sum + n.position.y, 0) / existingNodes.length;

  return {
    x: maxX + 350, // –û—Ç—Å—Ç—É–ø 350px –≤–ø—Ä–∞–≤–æ –æ—Ç –∫—Ä–∞–π–Ω–µ–π –ø—Ä–∞–≤–æ–π –Ω–æ–¥—ã
    y: avgY,        // –ü–æ —Å—Ä–µ–¥–Ω–µ–π Y —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –Ω–æ–¥
  };
}
```

---

## –ß–∞—Å—Ç—å 4: Frontend ‚Äî –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### 4.1 –°–µ—Ä–≤–∏—Å `flowTemplatesService.ts`

**–ü—É—Ç—å:** `frontend/src/services/flowTemplatesService.ts`

```typescript
export const flowTemplatesService = {
  // –ì–∞–ª–µ—Ä–µ—è
  getGallery: (params: GalleryQuery) =>
    api.get<GalleryResponse>('/flow-templates/gallery', { params }),
  getGalleryItem: (id: string) =>
    api.get<FlowTemplate>(`/flow-templates/gallery/${id}`),
  getCategories: () =>
    api.get<FlowTemplateCategory[]>('/flow-templates/categories'),

  // –ú–æ–∏ —Ç–µ–º–ø–ª–µ–π—Ç—ã
  getMy: () =>
    api.get<FlowTemplate[]>('/flow-templates/my'),
  create: (data: CreateFlowTemplateDto) =>
    api.post<FlowTemplate>('/flow-templates', data),
  update: (id: string, data: UpdateFlowTemplateDto) =>
    api.put<FlowTemplate>(`/flow-templates/${id}`, data),
  archive: (id: string) =>
    api.delete(`/flow-templates/${id}`),
  publish: (id: string) =>
    api.post(`/flow-templates/${id}/publish`),
  requestDeletion: (id: string, reason?: string) =>
    api.post(`/flow-templates/${id}/request-deletion`, { reason }),
  trackApply: (id: string) =>
    api.post(`/flow-templates/${id}/apply`),
};
```

### 4.2 `TemplateGallery` ‚Äî –ì–ª–∞–≤–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –≥–∞–ª–µ—Ä–µ–∏

**–ü—É—Ç—å:** `frontend/src/components/FlowBuilder/TemplateGallery/TemplateGallery.tsx`

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**

```
TemplateGallery/
‚îú‚îÄ‚îÄ TemplateGallery.tsx          # Drawer/Modal —Å –≥–∞–ª–µ—Ä–µ–µ–π
‚îú‚îÄ‚îÄ TemplateGallery.module.scss
‚îú‚îÄ‚îÄ GalleryFilters.tsx           # –ü–æ–∏—Å–∫ + —Ñ–∏–ª—å—Ç—Ä—ã (—Ç–∏–ø, –∫–∞—Ç–µ–≥–æ—Ä–∏—è, —Ç–µ–≥–∏)
‚îú‚îÄ‚îÄ TemplateCard.tsx             # –ö–∞—Ä—Ç–æ—á–∫–∞ —Ç–µ–º–ø–ª–µ–π—Ç–∞ –≤ —Å–ø–∏—Å–∫–µ
‚îú‚îÄ‚îÄ TemplatePreview.tsx          # –ú–æ–¥–∞–ª–∫–∞ –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞ (–º–∏–Ω–∏ ReactFlow readonly)
‚îî‚îÄ‚îÄ SaveAsTemplateModal.tsx      # –ú–æ–¥–∞–ª–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–≥–æ flow
```

**UI ‚Äî `TemplateGallery`:**
```
‚îå‚îÄ –ì–∞–ª–µ—Ä–µ—è —à–∞–±–ª–æ–Ω–æ–≤ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                                                                ‚îÇ
‚îÇ  [üîç –ü–æ–∏—Å–∫...]  [–¢–∏–ø ‚ñæ] [–ö–∞—Ç–µ–≥–æ—Ä–∏—è ‚ñæ] [–í—ã–±–æ—Ä –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã ‚òê]   ‚îÇ
‚îÇ                                                                ‚îÇ
‚îÇ  Tabs: [–ì–∞–ª–µ—Ä–µ—è] [–ú–æ–∏ —Ç–µ–º–ø–ª–µ–π—Ç—ã]                               ‚îÇ
‚îÇ                                                                ‚îÇ
‚îÇ  ‚òÖ –í—ã–±–æ—Ä –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã                                             ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê           ‚îÇ
‚îÇ  ‚îÇ E-commerce   ‚îÇ ‚îÇ –ü–æ–¥–¥–µ—Ä–∂–∫–∞    ‚îÇ ‚îÇ –ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ ‚îÇ           ‚îÇ
‚îÇ  ‚îÇ Full ‚Ä¢ 12 –Ω–æ–¥‚îÇ ‚îÇ Partial ‚Ä¢ 5  ‚îÇ ‚îÇ Full ‚Ä¢ 8 –Ω–æ–¥ ‚îÇ           ‚îÇ
‚îÇ  ‚îÇ 234 –∏—Å–ø.     ‚îÇ ‚îÇ 189 –∏—Å–ø.     ‚îÇ ‚îÇ 156 –∏—Å–ø.     ‚îÇ           ‚îÇ
‚îÇ  ‚îÇ [–ü—Ä–µ–≤—å—é]     ‚îÇ ‚îÇ [–ü—Ä–µ–≤—å—é]     ‚îÇ ‚îÇ [–ü—Ä–µ–≤—å—é]     ‚îÇ           ‚îÇ
‚îÇ  ‚îÇ [–ü—Ä–∏–º–µ–Ω–∏—Ç—å]  ‚îÇ ‚îÇ [–î–æ–±–∞–≤–∏—Ç—å]   ‚îÇ ‚îÇ [–ü—Ä–∏–º–µ–Ω–∏—Ç—å]  ‚îÇ           ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò           ‚îÇ
‚îÇ                                                                ‚îÇ
‚îÇ  –í—Å–µ —Ç–µ–º–ø–ª–µ–π—Ç—ã                                                 ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê           ‚îÇ
‚îÇ  ‚îÇ ...          ‚îÇ ‚îÇ ...          ‚îÇ ‚îÇ ...          ‚îÇ           ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò           ‚îÇ
‚îÇ                                                                ‚îÇ
‚îÇ  [‚Üê 1 2 3 ... ‚Üí]                                              ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**TemplateCard** ‚Äî –∫–∞—Ä—Ç–æ—á–∫–∞ —Ç–µ–º–ø–ª–µ–π—Ç–∞:
- –ù–∞–∑–≤–∞–Ω–∏–µ, –æ–ø–∏—Å–∞–Ω–∏–µ (truncated)
- –ë–µ–π–¥–∂–∏: —Ç–∏–ø (`Full` ‚Äî —Å–∏–Ω–∏–π, `Partial` ‚Äî –∑–µ–ª—ë–Ω—ã–π), –∫–∞—Ç–µ–≥–æ—Ä–∏—è, isPlatformChoice (‚òÖ)
- –ö–æ–ª-–≤–æ –Ω–æ–¥, –∫–æ–ª-–≤–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–π
- –ê–≤—Ç–æ—Ä (–∏–ª–∏ "–°–∏—Å—Ç–µ–º–Ω—ã–π")
- –ö–Ω–æ–ø–∫–∞ ¬´–ü—Ä–µ–≤—å—é¬ª ‚Üí –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç `TemplatePreview`
- –ö–Ω–æ–ø–∫–∞ ¬´–ü—Ä–∏–º–µ–Ω–∏—Ç—å¬ª (full) / ¬´–î–æ–±–∞–≤–∏—Ç—å –≤ flow¬ª (partial)

**TemplatePreview** ‚Äî –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä:
- ReactFlow –≤ readonly-—Ä–µ–∂–∏–º–µ (`nodesDraggable={false}`, `nodesConnectable={false}`)
- –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç `flowData` —Ç–µ–º–ø–ª–µ–π—Ç–∞
- –û–ø–∏—Å–∞–Ω–∏–µ, —Ç–µ–≥–∏, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- –ö–Ω–æ–ø–∫–∞ ¬´–ü—Ä–∏–º–µ–Ω–∏—Ç—å¬ª

### 4.3 `SaveAsTemplateModal` ‚Äî –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–∞–∫ —Ç–µ–º–ø–ª–µ–π—Ç

**–û—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –∏–∑:** FlowToolbar (–Ω–æ–≤–∞—è –∫–Ω–æ–ø–∫–∞ ¬´–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–∞–∫ —Ç–µ–º–ø–ª–µ–π—Ç¬ª)

**–ü–æ–ª—è —Ñ–æ—Ä–º—ã:**
- `name` ‚Äî –Ω–∞–∑–≤–∞–Ω–∏–µ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ)
- `description` ‚Äî –æ–ø–∏—Å–∞–Ω–∏–µ (textarea)
- `type` ‚Äî Full / Partial (radio)
- `category` ‚Äî –≤—ã–±–æ—Ä –∏–∑ —Å–ø–∏—Å–∫–∞ –∏–ª–∏ –≤–≤–æ–¥ –Ω–æ–≤–æ–π
- `tags` ‚Äî —Ç–µ–≥–∏ (Select mode="tags")
- `initialStatus` ‚Äî ¬´–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø—Ä–∏–≤–∞—Ç–Ω–æ¬ª / ¬´–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–∞–∫ —á–µ—Ä–Ω–æ–≤–∏–∫¬ª

**–õ–æ–≥–∏–∫–∞:**
1. `flowData` –±–µ—Ä—ë—Ç—Å—è –∏–∑ —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è FlowBuilder
2. POST `/flow-templates` —Å –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
3. –£—Å–ø–µ—Ö ‚Üí notification + –æ–ø—Ü–∏—è ¬´–û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –≤ –≥–∞–ª–µ—Ä–µ—é?¬ª

### 4.4 –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ FlowBuilder

**–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ `FlowToolbar.tsx`:**
- –ù–æ–≤–∞—è –∫–Ω–æ–ø–∫–∞ ¬´–ì–∞–ª–µ—Ä–µ—è —à–∞–±–ª–æ–Ω–æ–≤¬ª (–∏–∫–æ–Ω–∫–∞: AppstoreOutlined) ‚Äî –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç `TemplateGallery`
- –ù–æ–≤–∞—è –∫–Ω–æ–ø–∫–∞ ¬´–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–∞–∫ —Ç–µ–º–ø–ª–µ–π—Ç¬ª (–∏–∫–æ–Ω–∫–∞: SaveOutlined) ‚Äî –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç `SaveAsTemplateModal`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ `FlowBuilder.tsx`:**
- State: `galleryOpen`, `saveTemplateOpen`
- Callback `handleApplyTemplate(template: FlowTemplate)`:
  - –ï—Å–ª–∏ `template.type === 'full'`:
    - Confirm ‚Üí –∑–∞–º–µ–Ω–∏—Ç—å flow
    - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–æ–≤—ã—Ö id ‚Üí setNodes, setEdges ‚Üí fitView
  - –ï—Å–ª–∏ `template.type === 'partial'`:
    - –†–∞—Å—Å—á–∏—Ç–∞—Ç—å offset ‚Üí –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–¥—ã/—Ä—ë–±—Ä–∞ ‚Üí —Å–∫—Ä–æ–ª–ª –∫ –Ω–æ–≤—ã–º
  - POST `/flow-templates/:id/apply` (—É—á—ë—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è)

**–†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ `PresetSelector`:**
- `PresetSelector` –∏ `flowPresets/` —É–¥–∞–ª—è—é—Ç—Å—è —Å—Ä–∞–∑—É ‚Äî –≥–∞–ª–µ—Ä–µ—è –ø–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–º–µ–Ω—è–µ—Ç –∏—Ö
- –ù–æ–≤—ã–µ —Å–∏—Å—Ç–µ–º–Ω—ã–µ —à–∞–±–ª–æ–Ω—ã —Å–æ–∑–¥–∞—é—Ç—Å—è –ø–æ–∑–∂–µ —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å

### 4.5 –í–∫–ª–∞–¥–∫–∞ ¬´–ú–æ–∏ —Ç–µ–º–ø–ª–µ–π—Ç—ã¬ª

–í `TemplateGallery` ‚Äî –≤—Ç–æ—Ä–∞—è –≤–∫–ª–∞–¥–∫–∞:

```
‚îå‚îÄ –ú–æ–∏ —Ç–µ–º–ø–ª–µ–π—Ç—ã ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                                                                ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
‚îÇ  ‚îÇ –ú–æ–π FAQ –±–æ—Ç          Draft     [–†–µ–¥.] [–£–¥–∞–ª.] [–û–ø—É–±–ª.]  ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ Partial ‚Ä¢ 5 –Ω–æ–¥ ‚Ä¢ –°–æ–∑–¥–∞–Ω 10.02.2025                      ‚îÇ  ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§  ‚îÇ
‚îÇ  ‚îÇ E-commerce flow      Published [–†–µ–¥.] [–ó–∞–ø—Ä–æ—Å —É–¥–∞–ª.]     ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ Full ‚Ä¢ 15 –Ω–æ–¥ ‚Ä¢ 42 –∏—Å–ø. ‚Ä¢ –û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω 05.02.2025        ‚îÇ  ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§  ‚îÇ
‚îÇ  ‚îÇ –°—Ç–∞—Ä—ã–π flow          PendingDel                          ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ Full ‚Ä¢ 6 –Ω–æ–¥ ‚Ä¢ –û–∂–∏–¥–∞–µ—Ç —Ä–µ—à–µ–Ω–∏—è –∞–¥–º–∏–Ω–∞                    ‚îÇ  ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§  ‚îÇ
‚îÇ  ‚îÇ –¢–µ—Å—Ç–æ–≤—ã–π flow        Rejected  [–†–µ–¥.] [–£–¥–∞–ª.] [–ü–æ–≤—Ç.]   ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ Full ‚Ä¢ 8 –Ω–æ–¥ ‚Ä¢ –ü—Ä–∏—á–∏–Ω–∞: "–î—É–±–ª–∏—Ä—É–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π"         ‚îÇ  ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
‚îÇ                                                                ‚îÇ
‚îÇ  –°—Ç–∞—Ç—É—Å—ã:                                                      ‚îÇ
‚îÇ  Draft ‚Äî —á–µ—Ä–Ω–æ–≤–∏–∫, —Ç–æ–ª—å–∫–æ –≤—ã –≤–∏–¥–∏—Ç–µ                             ‚îÇ
‚îÇ  Private ‚Äî —Å–æ—Ö—Ä–∞–Ω—ë–Ω, —Ç–æ–ª—å–∫–æ –≤—ã –≤–∏–¥–∏—Ç–µ                          ‚îÇ
‚îÇ  Pending ‚Äî –Ω–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏                                        ‚îÇ
‚îÇ  Published ‚Äî –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω –≤ –≥–∞–ª–µ—Ä–µ–µ                              ‚îÇ
‚îÇ  Rejected ‚Äî –æ—Ç–∫–ª–æ–Ω—ë–Ω (–º–æ–∂–Ω–æ –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∏ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–Ω–æ–≤–∞) ‚îÇ
‚îÇ  PendingDel ‚Äî –∑–∞–ø—Ä–æ—Å –Ω–∞ —É–¥–∞–ª–µ–Ω–∏–µ, –æ–∂–∏–¥–∞–µ—Ç —Ä–µ—à–µ–Ω–∏—è –∞–¥–º–∏–Ω–∞       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## –ß–∞—Å—Ç—å 5: –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å

### 5.1 Frontend ‚Äî `AdminFlowTemplatesPage`

**–ü—É—Ç—å:** `frontend/src/pages/Admin/FlowTemplates/AdminFlowTemplatesPage.tsx`

**–¢–∞–±–ª–∏—Ü–∞:**

| –ö–æ–ª–æ–Ω–∫–∞          | –û–ø–∏—Å–∞–Ω–∏–µ                                      |
|------------------|-----------------------------------------------|
| –ù–∞–∑–≤–∞–Ω–∏–µ         | name + isPlatformChoice badge                 |
| –¢–∏–ø              | full / partial badge                          |
| –ö–∞—Ç–µ–≥–æ—Ä–∏—è        | category.name (–ª–æ–∫–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ)                  |
| –°—Ç–∞—Ç—É—Å           | draft / private / pending / published / rejected / pending_deletion / archived |
| –ê–≤—Ç–æ—Ä            | authorName –∏–ª–∏ "–°–∏—Å—Ç–µ–º–Ω—ã–π"                    |
| –ù–æ–¥—ã             | nodeCount                                      |
| –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–π    | usageCount                                     |
| –î–∞—Ç–∞             | createdAt / publishedAt                        |
| –î–µ–π—Å—Ç–≤–∏—è         | –ü—Ä–æ—Å–º–æ—Ç—Ä, –†–µ–¥., –£–¥–∞–ª., –û–¥–æ–±—Ä–∏—Ç—å/–û—Ç–∫–ª–æ–Ω–∏—Ç—å     |

**–§–∏–ª—å—Ç—Ä—ã:**
- –ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é
- –§–∏–ª—å—Ç—Ä –ø–æ —Å—Ç–∞—Ç—É—Å—É (—Å –∞–∫—Ü–µ–Ω—Ç–æ–º –Ω–∞ `pending_review` ‚Äî –±–µ–π–¥–∂ —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º)
- –§–∏–ª—å—Ç—Ä –ø–æ —Ç–∏–ø—É
- –§–∏–ª—å—Ç—Ä –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏

**–§—É–Ω–∫—Ü–∏–∏:**
- –°–æ–∑–¥–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ —Ç–µ–º–ø–ª–µ–π—Ç–∞ (—Å –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–º FlowEditor ‚Äî –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º `FlowBuilder` –≤ —Ä–µ–∂–∏–º–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)
- –ü–æ–º–µ—Ç–∫–∞ ¬´–í—ã–±–æ—Ä –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã¬ª ‚Äî toggle –≤ —Å—Ç—Ä–æ–∫–µ –∏–ª–∏ –≤ –¥–µ—Ç–∞–ª—å–Ω–æ–º –ø—Ä–æ—Å–º–æ—Ç—Ä–µ
- –û–¥–æ–±—Ä–µ–Ω–∏–µ/–û—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ ‚Äî –∫–Ω–æ–ø–∫–∏ –≤ —Å—Ç—Ä–æ–∫–µ –¥–ª—è `pending_review` —Ç–µ–º–ø–ª–µ–π—Ç–æ–≤
- –ü—Ä–∏ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–∏ ‚Äî –º–æ–¥–∞–ª–∫–∞ —Å –ø–æ–ª–µ–º –≤–≤–æ–¥–∞ –ø—Ä–∏—á–∏–Ω—ã

### 5.2 Frontend ‚Äî `AdminFlowTemplateCategoriesPage`

**–ü—É—Ç—å:** `frontend/src/pages/Admin/FlowTemplateCategories/AdminFlowTemplateCategoriesPage.tsx`

**–¢–∞–±–ª–∏—Ü–∞:**

| –ö–æ–ª–æ–Ω–∫–∞      | –û–ø–∏—Å–∞–Ω–∏–µ                                |
|--------------|----------------------------------------|
| –ò–∫–æ–Ω–∫–∞       | icon (emoji / Ant Design icon)         |
| Slug         | slug                                    |
| –ù–∞–∑–≤–∞–Ω–∏–µ     | name –ø–æ —Ç–µ–∫—É—â–µ–º—É —è–∑—ã–∫—É –∞–¥–º–∏–Ω–∫–∏          |
| –°—Ç–∞—Ç—É—Å       | isActive toggle                         |
| –ü–æ—Ä—è–¥–æ–∫      | sortOrder (drag & drop –∏–ª–∏ input)       |
| –î–µ–π—Å—Ç–≤–∏—è     | –†–µ–¥., –£–¥–∞–ª.                             |

**–ú–æ–¥–∞–ª–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:**
- `slug` ‚Äî —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä (–∞–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–∑ ru-–Ω–∞–∑–≤–∞–Ω–∏—è, —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º—ã–π)
- `icon` ‚Äî –≤—ã–±–æ—Ä emoji –∏–ª–∏ –∏–∫–æ–Ω–∫–∏
- `name` ‚Äî 5 –ø–æ–ª–µ–π –≤–≤–æ–¥–∞ –ø–æ —è–∑—ã–∫–∞–º (ru, en, pl, de, ua), —Å —Ç–∞–±–∞–º–∏ –∏–ª–∏ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–º —Å–ø–∏—Å–∫–æ–º
- `description` ‚Äî 5 –ø–æ–ª–µ–π –≤–≤–æ–¥–∞ –ø–æ —è–∑—ã–∫–∞–º (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- `isActive` ‚Äî switch
- `sortOrder` ‚Äî —á–∏—Å–ª–æ

### 5.3 –ê–¥–º–∏–Ω API –≤ `adminApi.ts`

```typescript
export const flowTemplatesAdminApi = {
  getAll: (params?) =>
    adminFetch<PaginatedResponse<FlowTemplate>>('/admin/flow-templates', params),
  getById: (id: string) =>
    adminFetch<FlowTemplate>(`/admin/flow-templates/${id}`),
  create: (data: CreateFlowTemplateDto) =>
    adminFetch<FlowTemplate>('/admin/flow-templates', { method: 'POST', body: data }),
  update: (id: string, data: UpdateFlowTemplateDto) =>
    adminFetch<FlowTemplate>(`/admin/flow-templates/${id}`, { method: 'PUT', body: data }),
  archive: (id: string) =>
    adminFetch(`/admin/flow-templates/${id}`, { method: 'DELETE' }),
  approve: (id: string) =>
    adminFetch(`/admin/flow-templates/${id}/approve`, { method: 'POST' }),
  reject: (id: string, reason: string) =>
    adminFetch(`/admin/flow-templates/${id}/reject`, { method: 'POST', body: { reason } }),
  approveDeletion: (id: string) =>
    adminFetch(`/admin/flow-templates/${id}/approve-deletion`, { method: 'POST' }),
  rejectDeletion: (id: string, reason?: string) =>
    adminFetch(`/admin/flow-templates/${id}/reject-deletion`, { method: 'POST', body: { reason } }),
  setPlatformChoice: (id: string, isPlatformChoice: boolean) =>
    adminFetch(`/admin/flow-templates/${id}/platform-choice`, {
      method: 'POST', body: { isPlatformChoice }
    }),
  duplicate: (id: string) =>
    adminFetch<FlowTemplate>(`/admin/flow-templates/${id}/duplicate`, { method: 'POST' }),
};

export const flowTemplateCategoriesAdminApi = {
  getAll: () =>
    adminFetch<FlowTemplateCategory[]>('/admin/flow-template-categories'),
  create: (data: UpsertCategoryDto) =>
    adminFetch<FlowTemplateCategory>('/admin/flow-template-categories', { method: 'POST', body: data }),
  update: (id: string, data: UpsertCategoryDto) =>
    adminFetch<FlowTemplateCategory>(`/admin/flow-template-categories/${id}`, { method: 'PUT', body: data }),
  delete: (id: string) =>
    adminFetch(`/admin/flow-template-categories/${id}`, { method: 'DELETE' }),
};
```

---

## –ß–∞—Å—Ç—å 6: –°–≤—è–∑—å —Å PLAN_SMART_SETUP –∏ —É–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–µ—Å–µ—Ç–æ–≤

### 6.1 –£–¥–∞–ª–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –ø—Ä–µ—Å–µ—Ç–æ–≤

–¢–µ–∫—É—â–∏–µ 18 –ª–æ–∫–∞–ª—å–Ω—ã—Ö –ø—Ä–µ—Å–µ—Ç–æ–≤ (`frontend/src/flowPresets/`) —É–¥–∞–ª—è—é—Ç—Å—è –ø–æ–ª–Ω–æ—Å—Ç—å—é:
- –£–¥–∞–ª–∏—Ç—å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é `frontend/src/flowPresets/`
- –£–¥–∞–ª–∏—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç `PresetSelector` –∏ –µ–≥–æ –∏–º–ø–æ—Ä—Ç—ã –∏–∑ `FlowBuilder` / `FlowToolbar`
- –ù–æ–≤—ã–µ —Å–∏—Å—Ç–µ–º–Ω—ã–µ —à–∞–±–ª–æ–Ω—ã —Å–æ–∑–¥–∞—é—Ç—Å—è –ø–æ–∑–∂–µ —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å

### 6.2 –°–≤—è–∑—å —Å PLAN_SMART_SETUP

`FlowTemplate` **–∑–∞–º–µ–Ω—è–µ—Ç** `FlowPreset` –∏–∑ PLAN_SMART_SETUP:
- `OnboardingTemplate.flowPresetIds` ‚Üí —Å—Å—ã–ª–∞–µ—Ç—Å—è –Ω–∞ `FlowTemplate.id` –≤–º–µ—Å—Ç–æ `FlowPreset.id`
- Entity `FlowPreset` –Ω–µ —Å–æ–∑–¥–∞—ë—Ç—Å—è ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `FlowTemplate` —Å `status = 'published'`
- –ü—É–±–ª–∏—á–Ω—ã–π —ç–Ω–¥–ø–æ–∏–Ω—Ç –¥–ª—è PresetSelector (–ß–∞—Å—Ç—å 3.3 PLAN_SMART_SETUP) –∑–∞–º–µ–Ω—è–µ—Ç—Å—è API –≥–∞–ª–µ—Ä–µ–∏

---

## –ß–∞—Å—Ç—å 7: –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è

### 7.1 –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞

| –î–µ–π—Å—Ç–≤–∏–µ                         | –ö—Ç–æ –º–æ–∂–µ—Ç                        |
|----------------------------------|----------------------------------|
| –ü—Ä–æ—Å–º–æ—Ç—Ä –≥–∞–ª–µ—Ä–µ–∏                 | –õ—é–±–æ–π –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å|
| –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ–º–ø–ª–µ–π—Ç–∞               | –õ—é–±–æ–π –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å|
| –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–º–ø–ª–µ–π—Ç–∞         | –¢–æ–ª—å–∫–æ –∞–≤—Ç–æ—Ä (–∏–ª–∏ –∞–¥–º–∏–Ω)         |
| –£–¥–∞–ª–µ–Ω–∏–µ —Ç–µ–º–ø–ª–µ–π—Ç–∞ (draft/private/rejected) | –¢–æ–ª—å–∫–æ –∞–≤—Ç–æ—Ä (–∏–ª–∏ –∞–¥–º–∏–Ω) |
| –ó–∞–ø—Ä–æ—Å –Ω–∞ —É–¥–∞–ª–µ–Ω–∏–µ (published)   | –¢–æ–ª—å–∫–æ –∞–≤—Ç–æ—Ä                     |
| –û—Ç–ø—Ä–∞–≤–∫–∞ –Ω–∞ –º–æ–¥–µ—Ä–∞—Ü–∏—é            | –¢–æ–ª—å–∫–æ –∞–≤—Ç–æ—Ä                     |
| –û–¥–æ–±—Ä–µ–Ω–∏–µ/–û—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏  | –¢–æ–ª—å–∫–æ –∞–¥–º–∏–Ω                     |
| –û–¥–æ–±—Ä–µ–Ω–∏–µ/–û—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–∏—è    | –¢–æ–ª—å–∫–æ –∞–¥–º–∏–Ω                     |
| –ü–æ–º–µ—Ç–∫–∞ "–í—ã–±–æ—Ä –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã"        | –¢–æ–ª—å–∫–æ –∞–¥–º–∏–Ω                     |
| –°–æ–∑–¥–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ —Ç–µ–º–ø–ª–µ–π—Ç–∞    | –¢–æ–ª—å–∫–æ –∞–¥–º–∏–Ω                     |

### 7.2 –í–∞–ª–∏–¥–∞—Ü–∏—è `flowData`

–ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏/–æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —Ç–µ–º–ø–ª–µ–π—Ç–∞:
- `nodes` ‚Äî –º–∞—Å—Å–∏–≤, –Ω–µ–ø—É—Å—Ç–æ–π (–º–∏–Ω–∏–º—É–º 1 –Ω–æ–¥–∞)
- –ö–∞–∂–¥–∞—è –Ω–æ–¥–∞: `id` (string), `type` (–≤–∞–ª–∏–¥–Ω—ã–π FlowNodeType), `position` ({x, y}), `data` (object)
- `edges` ‚Äî –º–∞—Å—Å–∏–≤ (–º–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç–æ–π)
- –ö–∞–∂–¥—ã–π edge: `source` –∏ `target` —Å—Å—ã–ª–∞—é—Ç—Å—è –Ω–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ `node.id`
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä `flowData` JSON: 5 MB

### 7.3 Rate limits

- –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ–º–ø–ª–µ–π—Ç–æ–≤: 10 –≤ —á–∞—Å –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –û—Ç–ø—Ä–∞–≤–∫–∞ –Ω–∞ –º–æ–¥–µ—Ä–∞—Ü–∏—é: 5 –≤ —á–∞—Å –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

---

## –ß–∞—Å—Ç—å 8: –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∞–≤—Ç–æ—Ä—É

–ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Å—Ç–∞—Ç—É—Å–∞ —Ç–µ–º–ø–ª–µ–π—Ç–∞ –∞–≤—Ç–æ—Ä –ø–æ–ª—É—á–∞–µ—Ç in-app —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ.

### 8.1 –¢—Ä–∏–≥–≥–µ—Ä—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

| –°–æ–±—ã—Ç–∏–µ                          | –ü–æ–ª—É—á–∞—Ç–µ–ª—å | –¢–µ–∫—Å—Ç (ru)                                                    |
|----------------------------------|------------|---------------------------------------------------------------|
| –¢–µ–º–ø–ª–µ–π—Ç –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω (approved)  | –ê–≤—Ç–æ—Ä      | ¬´–í–∞—à —à–∞–±–ª–æ–Ω "{{name}}" –æ–¥–æ–±—Ä–µ–Ω –∏ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω –≤ –≥–∞–ª–µ—Ä–µ–µ¬ª       |
| –¢–µ–º–ø–ª–µ–π—Ç –æ—Ç–∫–ª–æ–Ω—ë–Ω (rejected)     | –ê–≤—Ç–æ—Ä      | ¬´–í–∞—à —à–∞–±–ª–æ–Ω "{{name}}" –æ—Ç–∫–ª–æ–Ω—ë–Ω. –ü—Ä–∏—á–∏–Ω–∞: {{reason}}¬ª         |
| –£–¥–∞–ª–µ–Ω–∏–µ –æ–¥–æ–±—Ä–µ–Ω–æ (archived)     | –ê–≤—Ç–æ—Ä      | ¬´–í–∞—à –∑–∞–ø—Ä–æ—Å –Ω–∞ —É–¥–∞–ª–µ–Ω–∏–µ —à–∞–±–ª–æ–Ω–∞ "{{name}}" –æ–¥–æ–±—Ä–µ–Ω¬ª            |
| –£–¥–∞–ª–µ–Ω–∏–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–æ               | –ê–≤—Ç–æ—Ä      | ¬´–ó–∞–ø—Ä–æ—Å –Ω–∞ —É–¥–∞–ª–µ–Ω–∏–µ —à–∞–±–ª–æ–Ω–∞ "{{name}}" –æ—Ç–∫–ª–æ–Ω—ë–Ω¬ª               |
| –ù–æ–≤—ã–π pending_review             | –ê–¥–º–∏–Ω      | ¬´–ù–æ–≤—ã–π —à–∞–±–ª–æ–Ω –Ω–∞ –º–æ–¥–µ—Ä–∞—Ü–∏—é: "{{name}}" –æ—Ç {{authorName}}¬ª      |
| –ù–æ–≤—ã–π pending_deletion           | –ê–¥–º–∏–Ω      | ¬´–ó–∞–ø—Ä–æ—Å –Ω–∞ —É–¥–∞–ª–µ–Ω–∏–µ —à–∞–±–ª–æ–Ω–∞ "{{name}}" –æ—Ç {{authorName}}¬ª      |

### 8.2 –†–µ–∞–ª–∏–∑–∞—Ü–∏—è

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –º–µ—Ö–∞–Ω–∏–∑–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –ø—Ä–æ–µ–∫—Ç–∞ (–µ—Å–ª–∏ –µ—Å—Ç—å NotificationsModule) –∏–ª–∏ EventEmitter:

```typescript
// –í FlowTemplatesService –ø–æ—Å–ª–µ —Å–º–µ–Ω—ã —Å—Ç–∞—Ç—É—Å–∞:
this.eventEmitter.emit('flow-template.status-changed', {
  templateId: template.id,
  templateName: template.name,
  authorId: template.authorId,
  oldStatus,
  newStatus,
  reason, // rejectionReason –∏–ª–∏ deletionRequestReason
});
```

Listener —Å–æ–∑–¥–∞—ë—Ç –∑–∞–ø–∏—Å—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —á–µ—Ä–µ–∑ WebSocket (–µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ–Ω–ª–∞–π–Ω).

---

## –ß–∞—Å—Ç—å 9: –ü–æ—Ä—è–¥–æ–∫ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è

### 9.1 –≠—Ç–∞–ø 1 ‚Äî Backend
- Entity `FlowTemplateCategory` + `FlowTemplate` + –º–∏–≥—Ä–∞—Ü–∏—è
- `FlowTemplatesModule` (controller, service, DTOs, categories)
- `AdminFlowTemplatesController` + `AdminFlowTemplateCategoriesController`

### 9.2 –≠—Ç–∞–ø 2 ‚Äî Frontend: —É–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä–æ–≥–æ + –≥–∞–ª–µ—Ä–µ—è
- –£–¥–∞–ª–∏—Ç—å `flowPresets/`, `PresetSelector`
- –ö–æ–º–ø–æ–Ω–µ–Ω—Ç `TemplateGallery` + –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ `FlowBuilder`
- `SaveAsTemplateModal`

### 9.3 –≠—Ç–∞–ø 3 ‚Äî –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
- `AdminFlowTemplateCategoriesPage` ‚Äî —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –∫–∞—Ç–µ–≥–æ—Ä–∏–π —Å i18n
- `AdminFlowTemplatesPage` ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ, –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è, —Å–æ–∑–¥–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —à–∞–±–ª–æ–Ω–æ–≤
- –°–æ–∑–¥–∞–Ω–∏–µ –Ω–∞—á–∞–ª—å–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π –∏ –ø–µ—Ä–≤—ã—Ö —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —à–∞–±–ª–æ–Ω–æ–≤ —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω–∫—É

### 9.4 –≠—Ç–∞–ø 4 ‚Äî –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∞–≤—Ç–æ—Ä—É –ø—Ä–∏ approve/reject
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∞–¥–º–∏–Ω—É –ø—Ä–∏ pending_review/pending_deletion

---

## –ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö

```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞—ë—Ç flow –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ
         ‚îÇ
         ‚ñº
  "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–∞–∫ —Ç–µ–º–ø–ª–µ–π—Ç"
         ‚îÇ
         ‚ñº
  POST /flow-templates
  { name, description, type, category, tags, flowData }
         ‚îÇ
         ‚ñº
  flow_templates (status: draft/private)
         ‚îÇ
         ‚ñº
  "–û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –≤ –≥–∞–ª–µ—Ä–µ—é"
         ‚îÇ
         ‚ñº
  POST /flow-templates/:id/publish
  (status ‚Üí pending_review)
         ‚îÇ
         ‚ñº
  –ê–¥–º–∏–Ω: GET /admin/flow-templates?status=pending_review
         ‚îÇ
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚ñº         ‚ñº
 Approve   Reject
    ‚îÇ         ‚îÇ
    ‚ñº         ‚ñº
 published  rejected
    ‚îÇ       (–∞–≤—Ç–æ—Ä –≤–∏–¥–∏—Ç –ø—Ä–∏—á–∏–Ω—É,
    ‚ñº        –º–æ–∂–µ—Ç –∏—Å–ø—Ä–∞–≤–∏—Ç—å –∏
 –ì–∞–ª–µ—Ä–µ—è    –ø–µ—Ä–µ–æ—Ç–ø—Ä–∞–≤–∏—Ç—å)
    ‚îÇ
    ‚ñº
 –î—Ä—É–≥–æ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:
 GET /flow-templates/gallery
         ‚îÇ
         ‚ñº
  "–ü—Ä–∏–º–µ–Ω–∏—Ç—å" / "–î–æ–±–∞–≤–∏—Ç—å –≤ flow"
         ‚îÇ
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚ñº         ‚ñº
  Full     Partial
    ‚îÇ         ‚îÇ
    ‚ñº         ‚ñº
 –ó–∞–º–µ–Ω–∏—Ç—å  –î–æ–±–∞–≤–∏—Ç—å —Ä—è–¥–æ–º
 –≤–µ—Å—å flow  —Å offset
```
